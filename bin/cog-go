#!/bin/bash

set -e

ARG_HOST=${WEBSERVER_HOST:-127.0.0.1}
ARG_PORT=${WEBSERVER_PORT:-8000}
ARG_DIR=${DOCUMENT_ROOT:-./}

if [ -e Cogfile ]; then
    source ./Cogfile
fi



while true ; do
    case "$1" in
        -h|--host)
            case "$2" in
                "") ARG_HOST='127.0.0.1' ; shift 2 ;;
                *) ARG_HOST=$2 ; shift 2 ;;
            esac ;;
        -p|--port)
            case "$2" in
                "") ARG_PORT='8000' ; shift 2 ;;
                *) ARG_PORT=$2 ; shift 2 ;;
            esac ;;
        -d|--dir)
            case "$2" in
                "") ARG_DIR='./' ; shift 2 ;;
                *) ARG_DIR=$2 ; shift 2 ;;
            esac ;;
        --) shift ; break ;;
	"") break ;;
        #*) echo "Internal error!" ; exit 1 ;;
    esac
done

pushd $ARG_DIR > /dev/null
php -S $ARG_HOST:$ARG_PORT
